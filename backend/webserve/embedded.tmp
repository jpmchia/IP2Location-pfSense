//package webserve

// var staticFiles embed.FS

// func getAllFilenames(efs *embed.FS) (files []string, err error) {
// 	if err := fs.WalkDir(efs, ".", func(path string, d fs.DirEntry, err error) error {
// 		if d.IsDir() {
// 			return nil
// 		}

// 		files = append(files, path)

// 		return nil
// 	}); err != nil {
// 		return nil, err
// 	}

// 	return files, nil
// }

// ServeStaticFiles serves the embedded files
// func ServeEmbeddedStaticFiles(e *echo.Echo) *echo.Echo {
// 	files, err := getAllFilenames(&staticFiles)
// 	if err != nil {
// 		panic(err)
// 	}

// 	staticFilesHandler := http.FileServer(getStaticFilesFs())

// 	for _, file := range files {
// 		urlPath := removePrefix(file, "static/")
// 		e.GET(urlPath, echo.WrapHandler(staticFilesHandler))
// 		fmt.Printf("Registering: %v => %v\n", urlPath, file)
// 	}

// 	e.GET("/*", echo.WrapHandler(http.StripPrefix("/static/", staticFilesHandler)))

// 	return e
// }

// func removePrefix(s string, prefix string) string {
// 	return s[len(prefix):]
// }

// // Gets the embedded file system
// func getStaticFilesFs() http.FileSystem {
// 	fsys, err := fs.Sub(staticFiles, "static")
// 	if err != nil {
// 		panic(err)
// 	}
// 	return http.FS(fsys)
// }

// func ServeStaticFiles(e *echo.Echo) *echo.Echo {
// 	staticFilesHandler := http.FileServer(getStaticFilesFs())
// 	e.GET("/", echo.WrapHandler(staticFilesHandler))
// 	e.GET("/static/*", echo.WrapHandler(http.StripPrefix("/static/", staticFilesHandler)))
// 	return e
// }

// func ServeStaticFilesWithMiddleware(e *echo.Echo) *echo.Echo {
// 	staticFilesHandler := http.FileServer(getStaticFilesFs())
// 	e.Pre(middleware.RewriteWithConfig(map[string]string{"/*": "/static/$1"}))
// 	e.GET("/", echo.WrapHandler(staticFilesHandler))
// 	e.GET("/static/*", echo.WrapHandler(http.StripPrefix("/static/", staticFilesHandler)))
// 	return e
// }

// Middleware to rewrite the path to the static files
// func contentRewrite(next echo.HandlerFunc) echo.HandlerFunc {
// 	//next = echo.WrapHandler(echo.MiddlewareFunc.Rewrite(map[string]string{"/*": "/static/$1"}))
// 	//return next

// 	return next
// }

// func ServeStaticFiles(e *echo.Echo) *echo.Echo {
// 	err := LoadTemplates()
// 	util.HandleError(err, "LoadTemplates")
// 	e.Pre(middleware.RewriteWithConfig(map[string]string{"/*": "/static/$1"))
// 	e.GET("/*", echo.WrapHandler(staticFilesHandler), contentRewrite)
// 	return e
// }

// var staticFilesHandler = echo.WrapHandler(http.FileServer(http.FS(staticFiles)))
// var staticFilesRewrite = echo.RewriteWithConfig(map[string]string{"/*": "/public/$1"})
